<!DOCTYPE html>
<html>
<head>
    <title>Child Event Widget</title>
    <script>
        window.console.log("**** Child Event Widget **** ");
    </script>

    <script src="../wapi/widget_api.js"></script>
    <script src="../wapi/publishEvents.js"></script>

    <script src="../node_modules/closure-library/closure/goog/base.js"></script>
    <script>
        goog.require('goog.userAgent');
    </script>
</head>
<body>
<script>
    wapi.subscribe("broadcast", function (msg) {
        wapi.dbgAssert(msg == "broadcast http://localhost:8080/UnitTests/parentEventWidget_test.html");
        wapi.publish("ack", msg);
        var text = document.createTextNode(msg);
        var div = document.createElement('div');
        div.appendChild(text);
        document.body.appendChild(div);
    });

    wapi.subscribe("echo", function (msg) {
        wapi.dbgAssert(msg == "echo http://localhost:8080/UnitTests/parentEventWidget_test.html");
        wapi.publish("echo", msg);
        var text = document.createTextNode(msg);
        var div = document.createElement('div');
        div.appendChild(text);
        document.body.appendChild(div);
    });


    var clickSubscribed = false;

    wapi.subscribe("sysEventSubscribe", function (msg) {
        if (goog.isArray(msg))
        {
            window.console.log("****** wapi.subscribe: sysEventSubscribe - " + msg.join(", "));
        }
        else if (goog.isString(msg))
        {
            window.console.log("****** wapi.subscribe: sysEventSubscribe - " + msg);
        }
        if (!clickSubscribed)
        {
            window.generateWidgetEvents(100);
            clickSubscribed = true;
        }
    });


    wapi.publish("start", "start");


</script>
<script src="childEventGenerator.js"></script>
</body>
</html>
